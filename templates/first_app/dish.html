<!DOCTYPE html>
{% load staticfiles %}

<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Dish</title>
  </head>
  <body>
    <!-- Dish Name -->
  <h1><a href = "{% url "dish" dish.id %}">{{ dish.name }}</a></h1>
    <!-- Restaurant that this dish belongs to -->
    <p><a href = "{% url "restaurant" dish.restaurant.id %}">{{ dish.restaurant.name }}</a></p>
    <!-- Dish Profile Picture -->
    {% if dish.dish_profile_pic.name == "" %}
      <img src="{% static "images/default-dish-profile.png" %}">
    {% else %}
      <img src="{{dish.dish_profile_pic.url}}" style="width:80%;">
    {% endif %}
    <!-- Dish Rating -->
    <p>{{ dish.get_average_rating }}<p>
    <!-- Dish information -->
    <p>{{ dish.information }}</p>

    <!-- Add Dish Rating -->
    {% if user.is_authenticated %}
      <form action="{% url "add_dish_rating" dish.id %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.path }}">
        <select name="dish_rating">
          <option value = 1> 1 </option>
          <option value = 2> 2 </option>
          <option value = 3> 3 </option>
          <option value = 4> 4 </option>
          <option value = 5> 5 </option>
        </select>
        <input type="submit">
      </form>
      {% endif %}

      <!-- Add Dish Review -->
      {% if user.is_authenticated %}
        <form action="{% url "add_dish_review" dish.id %}" method="POST">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.path }}">
          <input type="textarea" name="dish_review">
          <input type="submit">
        </form>
        {% endif %}

    <hr>

    <!-- Dish Reviews -->
    {% for review in dish.dishreview_set.all %}
      <!-- Reviewer's Name -->
      <p><a href = "{% url "profile" review.user.id %}">{{ review.user.first_name }}</a><p>
      <p>
      <!-- Reviewer's Profile Picture -->
      {% if review.user.userprofile.profile_pic.name == "" %}
        <img src="{% static "images/default-user-profile.png" %}">
      {% else %}
        <img src="{{review.user.userprofile.profile_pic.url}}">
      {% endif %}
      </p>
      <!-- Review -->
      {{ review.review }}
      <!-- Review Rating -->
      {{ review.get_average_rating }}
      <!-- Edit/Delete Review -->
      {% if user.id == review.user.id %}
        <a href="{% url "edit_dish_review" review.id %}">
        <button type="button" class="btn btn-info btn-sm">Edit Review</button> </a>
        <a href="{% url "delete_dish_review" review.id %}">
        <button type="button" class="btn btn-info btn-sm">Delete Review</button> </a>
      {% endif %}


      <hr>
    {% endfor %}



  </body>
</html>
